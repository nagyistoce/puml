<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>pUML: Document Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">pUML</div>
   <div id="projectbrief">pUML--phunctionalUMLeditor</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-slots">Public Slots</a> &#124;
<a href="#signals">Signals</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Document Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Document" -->
<p><code>#include &lt;<a class="el" href="document_8h_source.html">document.h</a>&gt;</code></p>

<p><a href="classDocument-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-slots"></a>
Public Slots</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#af3936be180cb438f9578edf50caf2a1d">drawList</a> (QPainter &amp;painter)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#ac4fb62b6113ce62934ac1d3948a8e43b">setSelectedObject</a> (const QPoint &amp;point)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a4601ce8219b1c44ae4dcef2d51d9e2ee">moveSelectedObject</a> (const QPoint &amp;point)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#ab083c74be4a967a99c30e5bc28cb2dbb">createObject</a> (const QPoint &amp;position)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a3bcd5dcc4efba82762de876ba318027a">createConnectionPoint1</a> (const QPoint &amp;point)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a0b9592ebaaeaef4be30aee568b840d75">createConnectionPoint2</a> (const QPoint &amp;point)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a4c282f30904039ff4f984f837dfb58a9">showPropertiesDialog</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#ae2dc5cc8077f84fcf208920105df1ed1">removeObject</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a425344c7b35fe8903dba675f99d49c2f">sendSelectedToFront</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#af840d459f409c82a1bc6b353d4e92f72">sendSelectedForward</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#abcfd1ceeeb682eea101554c3e54f1a70">sendSelectedToBack</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#aaac2160159b4ea96c7149559e9e3f26e">sendSelectedBackwards</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a44757e4a0f79b1928a9f171eef95ae2b">setDiagramType</a> (<a class="el" href="classBaseNode.html#aa551aa648e877b0717bac9fa58570fcd">BaseNode::DiagramType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a20536dacfcae37b96303446aca1ec0c8">changeSecondConnectionPointHint</a> (const QPoint &amp;point)</td></tr>
<tr><td colspan="2"><h2><a name="signals"></a>
Signals</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a46ff092bdc9ead218e926a504dc329ca">modifiedChanged</a> (bool modified)</td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#acdbcbe550084e8c20f4f67eb229ad66a">Document</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a92fa6d725baa7248052ecba873f96afc">Document</a> (QString fpath)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#ac2e3f62307dc22baac21ddc10fa1609c">~Document</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a066ba242e9668ffdfcd58785b82ec7de">addNodeToList</a> (<a class="el" href="classBaseNode.html">BaseNode</a> *newNode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a651f16a7787831dd5dade529007efdaa">setNewObjectID</a> (int prototypeID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a9409939da8e9f8536a1d334edaae3668">getNewObjectID</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a89ec2c397b4e8ff253221928ada46a66">setCanvasIndex</a> (int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a332acaaa2028de3b5d775637c961f404">getCanvasIndex</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBaseNode.html#aa551aa648e877b0717bac9fa58570fcd">BaseNode::DiagramType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a9f71a25956993e1a3556007e82a9583d">getDiagramType</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#abc205e7c37998d66c9a8ab46f4821fd5">saveDocument</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a7b828c665f035c9fd68e7af0fef52bd7">openDocument</a> (QString openName)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a78319276da8efb8572c5648d5f38c18b">hasFilename</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#a9da7a4058bd8599d86f5b5a1c9124907">setFilename</a> (QString filename)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#af0252374861071c90895ee022041f15c">getModified</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classBaseNode.html">BaseNode</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="acdbcbe550084e8c20f4f67eb229ad66a"></a><!-- doxytag: member="Document::Document" ref="acdbcbe550084e8c20f4f67eb229ad66a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Document::Document </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor: simply initializes indexOfSelectedObject. </p>
<div class="fragment"><pre class="fragment">                   {
  indexOfSelectedObject = -1;
  fileName = <span class="stringliteral">&quot;&quot;</span>;
  modifiedFlag = <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a92fa6d725baa7248052ecba873f96afc"></a><!-- doxytag: member="Document::Document" ref="a92fa6d725baa7248052ecba873f96afc" args="(QString fpath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Document::Document </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>fpath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                {
  fprintf(stderr, <span class="stringliteral">&quot;&gt; Document::Document(QString fpath)\n&quot;</span>);

  QFile* xml_file = <span class="keyword">new</span> QFile(fpath);
  <span class="keywordflow">if</span> (!xml_file-&gt;open(QIODevice::ReadOnly | QIODevice::Text)) {
    <span class="keywordtype">char</span> msg[256];
    sprintf(msg, <span class="stringliteral">&quot;Couldn&#39;t open the file %s&quot;</span>,
            fpath.toStdString().c_str());
    QMessageBox::critical(<span class="keyword">this</span>, <span class="stringliteral">&quot;Load XML File Problem&quot;</span>, msg, QMessageBox::Ok);
    <span class="keywordflow">return</span>;
  }

  fprintf(stderr, <span class="stringliteral">&quot;&lt; Document::Document(QString fpath)\n&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac2e3f62307dc22baac21ddc10fa1609c"></a><!-- doxytag: member="Document::~Document" ref="ac2e3f62307dc22baac21ddc10fa1609c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Document::~Document </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor: frees up the memory used up by the vector of nodes. </p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>There is an intermitten bug where an exception will be thrown by .at()! </dd></dl>
<div class="fragment"><pre class="fragment">                    {
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()); i++) {
    assert(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(i) != 0);
    <span class="comment">// QMessageBox::information(0, &quot;node text&quot;, nodes.at(i)-&gt;getText(),</span>
    <span class="comment">//                          QMessageBox::Ok, QMessageBox::Ok);</span>
    <span class="keyword">delete</span> <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(i);
  }
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a066ba242e9668ffdfcd58785b82ec7de"></a><!-- doxytag: member="Document::addNodeToList" ref="a066ba242e9668ffdfcd58785b82ec7de" args="(BaseNode *newNode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::addNodeToList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseNode.html">BaseNode</a> *&#160;</td>
          <td class="paramname"><em>newNode</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.push_back(newNode); }
</pre></div>
</div>
</div>
<a class="anchor" id="a20536dacfcae37b96303446aca1ec0c8"></a><!-- doxytag: member="Document::changeSecondConnectionPointHint" ref="a20536dacfcae37b96303446aca1ec0c8" args="(const QPoint &amp;point)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::changeSecondConnectionPointHint </td>
          <td>(</td>
          <td class="paramtype">const QPoint &amp;&#160;</td>
          <td class="paramname"><em>point</em></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                                                  {
  <span class="comment">// reset the cpSelection for the previous selected node</span>
  <span class="keywordflow">if</span> ((secondConnectionIndex &gt; -1)
      &amp;&amp; (secondConnectionIndex &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()))) {
    <span class="keywordflow">if</span> (secondConnectionIndex != firstConnectionIndex) {
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(secondConnectionIndex)-&gt;setSelectedForConnectionPoint(<span class="keyword">false</span>);
    }
  }

  <span class="keywordflow">if</span> (firstConnectionIndex != -1) {
    <span class="comment">// find the new node, if any</span>
    secondConnectionIndex = getIndexAt(point);
    <span class="keywordflow">if</span> (secondConnectionIndex != -1) {
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(secondConnectionIndex)-&gt;setSelectedForConnectionPoint(<span class="keyword">true</span>);
    }
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3bcd5dcc4efba82762de876ba318027a"></a><!-- doxytag: member="Document::createConnectionPoint1" ref="a3bcd5dcc4efba82762de876ba318027a" args="(const QPoint &amp;point)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::createConnectionPoint1 </td>
          <td>(</td>
          <td class="paramtype">const QPoint &amp;&#160;</td>
          <td class="paramname"><em>point</em></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. Sets the object index in a new connection node. Sets firstConnectionIndex to either some valid index or -1 if the first connection point is invalid. </p>
<div class="fragment"><pre class="fragment">                                                         {
  <span class="comment">// Find the object under the point. -1 signifies either</span>
  <span class="comment">// no object found or connector found</span>
  firstConnectionIndex = getIndexAt(point);
  <span class="keywordflow">if</span> ((firstConnectionIndex != -1) &amp;&amp;
      (<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(firstConnectionIndex)-&gt;isConnector() == <span class="keyword">true</span>)) {
    firstConnectionIndex = -1;
  }
  <span class="comment">// set the connection point selection property, so a visual</span>
  <span class="comment">// aid will be drawn for the object that is selected for the</span>
  <span class="comment">// connection</span>
  <span class="keywordflow">if</span> (firstConnectionIndex != -1) {
    <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(firstConnectionIndex)-&gt;setSelectedForConnectionPoint(<span class="keyword">true</span>);
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0b9592ebaaeaef4be30aee568b840d75"></a><!-- doxytag: member="Document::createConnectionPoint2" ref="a0b9592ebaaeaef4be30aee568b840d75" args="(const QPoint &amp;point)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::createConnectionPoint2 </td>
          <td>(</td>
          <td class="paramtype">const QPoint &amp;&#160;</td>
          <td class="paramname"><em>point</em></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. Sets the second point in a new connection node. This function actually creates the node using the <a class="el" href="classNodeFactory.html">NodeFactory</a>. It doesn't create the node if the first or second point is invalid. </p>
<div class="fragment"><pre class="fragment">                                                         {
  <span class="comment">// Create the object only if a valid first object was found</span>
  <span class="keywordtype">int</span> index;
  <span class="comment">// creates a temp object node for self connectors</span>
  <a class="code" href="classBaseNode.html">BaseNode</a> *tempnode;
  tempnode = <a class="code" href="classNodeFactory.html#a4d54b734a6928d59d8aeff971d091a7b">NodeFactory::getInstance</a>()-&gt;<a class="code" href="classNodeFactory.html#a781f3a67f9bf486c741de69ce8a58f4b">produce</a>(newObjectID);

  <span class="keywordflow">if</span> (firstConnectionIndex != -1) {
    index = getIndexAt(point);
    <span class="comment">// And the second index was found</span>
    <span class="keywordflow">if</span> (((index != -1) &amp;&amp;
         (<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index)-&gt;isConnector() == <span class="keyword">false</span>)) &amp;&amp;
            index != firstConnectionIndex) {
      <span class="comment">// produce the object</span>
      <a class="code" href="classBaseNode.html">BaseNode</a> *newNode;
      newNode = <a class="code" href="classNodeFactory.html#a4d54b734a6928d59d8aeff971d091a7b">NodeFactory::getInstance</a>()-&gt;<a class="code" href="classNodeFactory.html#a781f3a67f9bf486c741de69ce8a58f4b">produce</a>(newObjectID);

      <span class="comment">// now connect the connection to both objects, and connect the</span>
      <span class="comment">// objects to the connections</span>
      newNode-&gt;<a class="code" href="classBaseNode.html#a50e8039bbf239e7add38be6c667cf9da">addConnectedNode</a>(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(firstConnectionIndex));
      newNode-&gt;<a class="code" href="classBaseNode.html#a50e8039bbf239e7add38be6c667cf9da">addConnectedNode</a>(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index));
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(firstConnectionIndex)-&gt;addConnectedNode(newNode);
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index)-&gt;addConnectedNode(newNode);

      <a class="code" href="classDocument.html#a066ba242e9668ffdfcd58785b82ec7de">addNodeToList</a>(newNode);
      ordering.append(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()-1);

      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index)-&gt;setSelectedForConnectionPoint(<span class="keyword">false</span>);

      setModified(<span class="keyword">true</span>);
      emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
    }
    <span class="comment">//  Self connectors</span>
    <span class="comment">// And the second index was found</span>
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((((index != -1) &amp;&amp;
         (<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index)-&gt;isConnector() == <span class="keyword">false</span>)) &amp;&amp;
            (index == firstConnectionIndex) &amp;&amp;
              (tempnode-&gt;<a class="code" href="classBaseNode.html#a86bd186e3435098add1b9bdd79e25cdb">getText</a>() == <span class="stringliteral">&quot;Collaboration Self Line&quot;</span>)) ||
             ((index != -1) &amp;&amp; (<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index)-&gt;isConnector() == <span class="keyword">false</span>)
             &amp;&amp;(index == firstConnectionIndex) &amp;&amp; (tempnode-&gt;<a class="code" href="classBaseNode.html#a86bd186e3435098add1b9bdd79e25cdb">getText</a>() == <span class="stringliteral">&quot;State Self Line&quot;</span>))) {

        <span class="comment">// produce the object</span>
      <a class="code" href="classBaseNode.html">BaseNode</a> *newNode;
      newNode = <a class="code" href="classNodeFactory.html#a4d54b734a6928d59d8aeff971d091a7b">NodeFactory::getInstance</a>()-&gt;<a class="code" href="classNodeFactory.html#a781f3a67f9bf486c741de69ce8a58f4b">produce</a>(newObjectID);

      <span class="comment">// now connect the connection to both objects, and connect the</span>
      <span class="comment">// objects to the connections</span>
      newNode-&gt;<a class="code" href="classBaseNode.html#a50e8039bbf239e7add38be6c667cf9da">addConnectedNode</a>(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(firstConnectionIndex));
      newNode-&gt;<a class="code" href="classBaseNode.html#a50e8039bbf239e7add38be6c667cf9da">addConnectedNode</a>(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index));
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(firstConnectionIndex)-&gt;addConnectedNode(newNode);
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index)-&gt;addConnectedNode(newNode);

      <a class="code" href="classDocument.html#a066ba242e9668ffdfcd58785b82ec7de">addNodeToList</a>(newNode);
      ordering.append(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()-1);

      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(index)-&gt;setSelectedForConnectionPoint(<span class="keyword">false</span>);

      setModified(<span class="keyword">true</span>);
      emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
    }
<span class="comment">// end of  self connect</span>
    <span class="keywordflow">else</span> {
      QMessageBox::information(0, <span class="stringliteral">&quot;pUML&quot;</span>, <span class="stringliteral">&quot;No second object selected&quot;</span>);
    }
  }

  <span class="keywordflow">if</span> (firstConnectionIndex != -1) {
    <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(firstConnectionIndex)-&gt;setSelectedForConnectionPoint(<span class="keyword">false</span>);
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab083c74be4a967a99c30e5bc28cb2dbb"></a><!-- doxytag: member="Document::createObject" ref="ab083c74be4a967a99c30e5bc28cb2dbb" args="(const QPoint &amp;position)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::createObject </td>
          <td>(</td>
          <td class="paramtype">const QPoint &amp;&#160;</td>
          <td class="paramname"><em>position</em></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. This will create a new object at the specified position. The prototypeID of the new object will have been set by a previous signal to setNewObjectID. Uses <a class="el" href="classNodeFactory.html">NodeFactory</a>. </p>
<div class="fragment"><pre class="fragment">                                                  {
  assert(indexOfSelectedObject &gt;= -1);
  assert(indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()));

  <span class="comment">// create a new node using the factory</span>
  <a class="code" href="classBaseNode.html">BaseNode</a>* newNode;
  newNode = <a class="code" href="classNodeFactory.html#a4d54b734a6928d59d8aeff971d091a7b">NodeFactory::getInstance</a>()-&gt;<a class="code" href="classNodeFactory.html#a781f3a67f9bf486c741de69ce8a58f4b">produce</a>(newObjectID);
  newNode-&gt;<a class="code" href="classBaseNode.html#aa6675efee5af9fc0e9b2e19c98e4b7dc">setPosition</a>(position);

  <span class="comment">// add newnode to a vector of nodes.</span>
  <a class="code" href="classDocument.html#a066ba242e9668ffdfcd58785b82ec7de">addNodeToList</a>(newNode);

  <span class="comment">// add the node to the ordering</span>
  ordering.append(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()-1);

  <span class="comment">// reset the selected property of previously selected node</span>
  <span class="keywordflow">if</span> (indexOfSelectedObject != -1) {
    <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject)-&gt;setSelected(<span class="keyword">false</span>);
  }

  <span class="comment">// set the selected index to be the created object</span>
  indexOfSelectedObject = <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()-1;
  <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject)-&gt;setSelected(<span class="keyword">true</span>);

  setModified(<span class="keyword">true</span>);
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="af3936be180cb438f9578edf50caf2a1d"></a><!-- doxytag: member="Document::drawList" ref="af3936be180cb438f9578edf50caf2a1d" args="(QPainter &amp;painter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::drawList </td>
          <td>(</td>
          <td class="paramtype">QPainter &amp;&#160;</td>
          <td class="paramname"><em>painter</em></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. This will draw the nodes using painter. It assumes that painter is a valid painter, and uses <a class="el" href="classBaseNode.html#a79627d9a052108d60082dddbd60dfb02">BaseNode.draw()</a>. </p>
<div class="fragment"><pre class="fragment">                                         {  <span class="comment">// NOLINT</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ordering.size(); i++) {
    <span class="keywordflow">if</span> (<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(ordering.at(i)) == 0) {
      qDebug() &lt;&lt; <span class="stringliteral">&quot;Drawing error: Ordering points to null node&quot;</span>;
    } <span class="keywordflow">else</span> {
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(ordering.at(i))-&gt;draw(painter);
    }
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a332acaaa2028de3b5d775637c961f404"></a><!-- doxytag: member="Document::getCanvasIndex" ref="a332acaaa2028de3b5d775637c961f404" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Document::getCanvasIndex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> canvasIndex; }
</pre></div>
</div>
</div>
<a class="anchor" id="a9f71a25956993e1a3556007e82a9583d"></a><!-- doxytag: member="Document::getDiagramType" ref="a9f71a25956993e1a3556007e82a9583d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBaseNode.html#aa551aa648e877b0717bac9fa58570fcd">BaseNode::DiagramType</a> Document::getDiagramType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> diagramType; }
</pre></div>
</div>
</div>
<a class="anchor" id="af0252374861071c90895ee022041f15c"></a><!-- doxytag: member="Document::getModified" ref="af0252374861071c90895ee022041f15c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Document::getModified </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> modifiedFlag; }
</pre></div>
</div>
</div>
<a class="anchor" id="a9409939da8e9f8536a1d334edaae3668"></a><!-- doxytag: member="Document::getNewObjectID" ref="a9409939da8e9f8536a1d334edaae3668" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Document::getNewObjectID </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> newObjectID; }
</pre></div>
</div>
</div>
<a class="anchor" id="a78319276da8efb8572c5648d5f38c18b"></a><!-- doxytag: member="Document::hasFilename" ref="a78319276da8efb8572c5648d5f38c18b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Document::hasFilename </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">if</span> (fileName == <span class="stringliteral">&quot;&quot;</span>) { <span class="keywordflow">return</span> <span class="keyword">false</span>; } <span class="keywordflow">else</span> { <span class="keywordflow">return</span> <span class="keyword">true</span>; } }
</pre></div>
</div>
</div>
<a class="anchor" id="a623b41b297d20acad5aeb477974abfa1"></a><!-- doxytag: member="Document::modelChanged" ref="a623b41b297d20acad5aeb477974abfa1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::modelChanged </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [signal]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a46ff092bdc9ead218e926a504dc329ca"></a><!-- doxytag: member="Document::modifiedChanged" ref="a46ff092bdc9ead218e926a504dc329ca" args="(bool modified)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::modifiedChanged </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>modified</em></td><td>)</td>
          <td><code> [signal]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4601ce8219b1c44ae4dcef2d51d9e2ee"></a><!-- doxytag: member="Document::moveSelectedObject" ref="a4601ce8219b1c44ae4dcef2d51d9e2ee" args="(const QPoint &amp;point)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::moveSelectedObject </td>
          <td>(</td>
          <td class="paramtype">const QPoint &amp;&#160;</td>
          <td class="paramname"><em>point</em></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. This will move whatever object is selected to the new point, while adding in the delta that was saved by a previous call to setSelectedObject. </p>
<div class="fragment"><pre class="fragment">                                                     {
  assert(indexOfSelectedObject &gt;= -1);
  assert(indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()));

  <span class="keywordflow">if</span> (indexOfSelectedObject != -1) {
    <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject)-&gt;setPosition(point + positionDelta);
  }

  setModified(<span class="keyword">true</span>);
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7b828c665f035c9fd68e7af0fef52bd7"></a><!-- doxytag: member="Document::openDocument" ref="a7b828c665f035c9fd68e7af0fef52bd7" args="(QString openName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::openDocument </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>openName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Opens specified file. This function does not ask the user to save an unsaved modified diagram. That is the MainWindow's job. This function will simply clear out the node vector and load the file in. </p>
<div class="fragment"><pre class="fragment">{
    QDomDocument* xmlDoc = <a class="code" href="document_8cpp.html#a5f17aca6a0b1fe3972dc239f54c44e6b">openSaveFile</a>(openName);
    QDomElement docElem = <a class="code" href="document_8cpp.html#a249d1c8f88c7c49c9ee91ff035a8c3c4">getNextDocumentElement</a>(xmlDoc);
    QDomElement nodesVectorElement;
    QDomElement n;
    <a class="code" href="classBaseNode.html">BaseNode</a>* newNode;

    <span class="comment">// Clear the nodes vector</span>
    <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.clear();
    ordering.clear();

    <span class="comment">// Get the diagram type</span>
    diagramType = <span class="keyword">static_cast&lt;</span><a class="code" href="classBaseNode.html#aa551aa648e877b0717bac9fa58570fcd">BaseNode::DiagramType</a><span class="keyword">&gt;</span>(docElem.attribute(<span class="stringliteral">&quot;diagramType&quot;</span>).toInt());

    <span class="comment">// First get out the first (and hopefully only) nodes_vector_element.</span>
    nodesVectorElement = docElem.firstChildElement(<span class="stringliteral">&quot;nodes_vector_element&quot;</span>);

    <span class="comment">// Now we have to iterate over all the Node elements and restor them.</span>
    <span class="comment">// This style of iteration loop was taken from the Qt documentation for</span>
    <span class="comment">// QDomElement.</span>
    n = nodesVectorElement.firstChildElement(<span class="stringliteral">&quot;Node&quot;</span>);
    <span class="keywordflow">for</span> (; !n.isNull(); n = n.nextSiblingElement(<span class="stringliteral">&quot;Node&quot;</span>)) {
      <span class="comment">// Now that we have the QDomElement, try to produce the node</span>
      newNode = <a class="code" href="classNodeFactory.html#a4d54b734a6928d59d8aeff971d091a7b">NodeFactory::getInstance</a>()-&gt;<a class="code" href="classNodeFactory.html#ac2a8a4d0f2183fb4c1552b2994839b4c">produceFromClassName</a>(n.attribute(<span class="stringliteral">&quot;class_name&quot;</span>));

      <span class="comment">// Check we failed</span>
      <span class="keywordflow">if</span> (newNode == 0) {
        qDebug() &lt;&lt; <span class="stringliteral">&quot;Document::openDocument Error: Couldn&#39;t produce a &quot;</span> &lt;&lt; n.attribute(<span class="stringliteral">&quot;class_name&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; with the node factory.&quot;</span>;
      } <span class="keywordflow">else</span> {
        <span class="comment">// Restore the unique id and all the properties</span>
        newNode-&gt;<a class="code" href="classBaseNode.html#abac36881ca914e10499fa307ddd7c924">from_xml</a>(n);

        <span class="comment">// Push the node onto the node vector</span>
        <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.push_back(newNode);
        ordering.push_back(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()-1);
      }
    }

    <span class="comment">// Now that we have all the id&#39;s restored, we can restore the connections</span>
    <span class="comment">// between the nodes. We loop over all the Node elements in</span>
    <span class="comment">// node_vector_element and loop over all the ConnectedObject elements in</span>
    <span class="comment">// each Node.</span>
    n = nodesVectorElement.firstChildElement(<span class="stringliteral">&quot;Node&quot;</span>);
    <span class="keywordflow">for</span> (; !n.isNull(); n = n.nextSiblingElement(<span class="stringliteral">&quot;Node&quot;</span>)) {
      <a class="code" href="classBaseNode.html">BaseNode</a>* sourcenode;
      QUuid sourceid;

      <span class="comment">// Find the node that we created earlier from this element</span>
      sourceid = QUuid(n.attribute(<span class="stringliteral">&quot;Id&quot;</span>));
      sourcenode = this-&gt;findNodeById(sourceid);

      <span class="keywordflow">if</span> (sourcenode == 0) {
        qDebug() &lt;&lt; <span class="stringliteral">&quot;Document::openDocument Error: Couldn&#39;t find source node by id&quot;</span>;
      } <span class="keywordflow">else</span> {
        QUuid targetid;
        <a class="code" href="classBaseNode.html">BaseNode</a>* targetnode;

        <span class="comment">// Now that we have the element and it&#39;s associated node, iterate</span>
        <span class="comment">// over all of the element&#39;s children (&quot;ConnectedObjects&quot;)</span>
        QDomElement child = n.firstChildElement(<span class="stringliteral">&quot;ConnectedObject&quot;</span>);
        <span class="keywordflow">for</span> (; !child.isNull(); child = child.nextSiblingElement(<span class="stringliteral">&quot;ConnectedObject&quot;</span>)) {
          <span class="comment">// Find the targeted node by id</span>
          targetid = QUuid(child.attribute(<span class="stringliteral">&quot;id&quot;</span>));
          targetnode = this-&gt;findNodeById(targetid);

          <span class="comment">// Check if it failed</span>
          <span class="keywordflow">if</span> (targetnode == 0) {
            qDebug() &lt;&lt; <span class="stringliteral">&quot;Document::openDocument Error: Couldn&#39;t find a target node by id&quot;</span>;
          } <span class="keywordflow">else</span> {
            <span class="comment">// If it didn&#39;t fail, add the connection!</span>
            sourcenode-&gt;addConnectedNode(targetnode);
          }
        }
      }
    }

    <a class="code" href="classDocument.html#a9da7a4058bd8599d86f5b5a1c9124907">setFilename</a>(openName);
    setModified(<span class="keyword">false</span>);
    update();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae2dc5cc8077f84fcf208920105df1ed1"></a><!-- doxytag: member="Document::removeObject" ref="ae2dc5cc8077f84fcf208920105df1ed1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::removeObject </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. Removes the currently selected node. If the node is an object, it also removes all connections connected to that node. </p>
<div class="fragment"><pre class="fragment">                            {
  assert(indexOfSelectedObject &gt;= -1);
  assert(indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()));

  <span class="keywordflow">if</span> (indexOfSelectedObject != -1) {
    <a class="code" href="classBaseNode.html">BaseNode</a>* obj = <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject);
    <span class="keywordflow">if</span> (obj-&gt;<a class="code" href="classBaseNode.html#a7f1ca77b551e9d5320fb08512c9f3d47">isConnector</a>() == <span class="keyword">false</span>) {
      <span class="comment">// erase all the connected connectionnodes</span>
      <span class="comment">// get the list of connected nodes, which are all connections</span>
      std::list&lt;BaseNode*&gt; objs;
      objs = obj-&gt;<a class="code" href="classBaseNode.html#a675cf32e2fc48b0a8cf2697b56488721">getConnectedNodes</a>();

      <span class="comment">// iterator through that list and delete the connection nodes</span>
      <span class="comment">// as well as remove the pointers to this node from all objects</span>
      <span class="comment">// that are connected to the connection node</span>
      std::list&lt;BaseNode*&gt;::iterator it;
      <span class="keywordflow">for</span> (it = objs.begin(); it != objs.end(); ++it) {
        <span class="comment">// for each of the objects that are connected to this connection,</span>
        std::list&lt;BaseNode*&gt; secondaryObject;
        std::list&lt;BaseNode*&gt;::iterator it2;
        <span class="keywordflow">for</span> (it2 = secondaryObject.begin(); it2 != secondaryObject.end(); ++it) {  <span class="comment">// NOLINT</span>
          <span class="comment">// remove the connection back to the connectionode we are deleting</span>
          (*it2)-&gt;removeConnectedNode(*it);
        }

        <span class="comment">// delete this connection node</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()); i++) {
          <span class="keywordflow">if</span> (<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(i) == (*it)) {
            removeFromOrdering(i);
            <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.erase(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.begin()+i);
          }
        }
      }
      <span class="comment">// now actually erase the object</span>
      removeFromOrdering(indexOfSelectedObject);
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.erase(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.begin()+indexOfSelectedObject);
    } <span class="keywordflow">else</span> {
      <span class="comment">// get the list of connected objects (should only be two objects)</span>
      std::list&lt;BaseNode*&gt; secondaryObjects;
      secondaryObjects = obj-&gt;<a class="code" href="classBaseNode.html#a675cf32e2fc48b0a8cf2697b56488721">getConnectedNodes</a>();

      <span class="comment">// iterate through the list and disconnect the connectionnode we</span>
      <span class="comment">// are deleting from the objects.</span>
      std::list&lt;BaseNode*&gt;::iterator it;  <span class="comment">// NOLINT</span>
      <span class="keywordflow">for</span> (it = secondaryObjects.begin(); it != secondaryObjects.end(); ++it) {
        (*it)-&gt;removeConnectedNode(obj);
      }

      <span class="comment">// now delete the actual nodecount</span>
      removeFromOrdering(indexOfSelectedObject);
      <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.erase(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.begin()+indexOfSelectedObject);
    }
  }
  setModified(<span class="keyword">true</span>);
  indexOfSelectedObject = -1;
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="abc205e7c37998d66c9a8ab46f4821fd5"></a><!-- doxytag: member="Document::saveDocument" ref="abc205e7c37998d66c9a8ab46f4821fd5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::saveDocument </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Saves the document to a file. The file is specified by the fileName member variable. If the member variable isn't set, the function exits. If the file is an invalid file, the function produces an error message to the user. This function shouldn't ever be called when the filename isn't set. </p>
<div class="fragment"><pre class="fragment">                            {
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classDocument.html#a78319276da8efb8572c5648d5f38c18b">hasFilename</a>() != <span class="keyword">false</span>) {
    QMessageBox::information(<span class="keyword">this</span>, <span class="stringliteral">&quot;pUML&quot;</span>, <span class="stringliteral">&quot;Trying to open file &quot;</span> + fileName + <span class="stringliteral">&quot; for saving&quot;</span>);
    QFile file(fileName);
    QDomDocument xml_doc(<span class="stringliteral">&quot;pUML_save_document&quot;</span>);
    QDomElement documentElement = xml_doc.createElement(<span class="stringliteral">&quot;document&quot;</span>);
    documentElement.setAttribute(<span class="stringliteral">&quot;diagramType&quot;</span>, diagramType);
    xml_doc.appendChild(documentElement);
    QDomElement nodesElement = xml_doc.createElement(<span class="stringliteral">&quot;nodes_vector_element&quot;</span>);
    documentElement.appendChild(nodesElement);

    <span class="keywordflow">for</span> (vector&lt;BaseNode*&gt;::iterator it = <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.begin();
         it != <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.end(); ++it) {
      (*it)-&gt;to_xml(xml_doc, nodesElement);
    }

    <span class="comment">// Checks to make sure that the file is writable.</span>
    <span class="keywordflow">if</span> (!file.open(QIODevice::WriteOnly)) {
        QMessageBox::information(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Unable to open file&quot;</span>),
                                 file.errorString());
        <span class="keywordflow">return</span>;
    }

    ofstream myfile;
    myfile.open(fileName.toStdString().c_str());
    myfile &lt;&lt; xml_doc.toString().toStdString();
    myfile.close();

    setModified(<span class="keyword">false</span>);
  } <span class="keywordflow">else</span> {
    qDebug() &lt;&lt; <span class="stringliteral">&quot;Document::saveDocument Error: No filename to save to!&quot;</span>;
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aaac2160159b4ea96c7149559e9e3f26e"></a><!-- doxytag: member="Document::sendSelectedBackwards" ref="aaac2160159b4ea96c7149559e9e3f26e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::sendSelectedBackwards </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If an object is selected, this slot will move that object's ordering back one spot. Nothing will happen if it's already at the back. </p>
<div class="fragment"><pre class="fragment">                                     {
  <span class="keywordflow">if</span> ((indexOfSelectedObject &gt; -1)
      &amp;&amp; (indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()))) {
    <span class="keywordtype">int</span> orderingindex = ordering.indexOf(indexOfSelectedObject);
    <span class="keywordflow">if</span> (orderingindex &gt; 0) {
      ordering.move(orderingindex, orderingindex-1);
    }
  }
  setModified(<span class="keyword">true</span>);
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="af840d459f409c82a1bc6b353d4e92f72"></a><!-- doxytag: member="Document::sendSelectedForward" ref="af840d459f409c82a1bc6b353d4e92f72" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::sendSelectedForward </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If an object is selected, this slot will move that object's ordering up on position. Nothing will happen if that object is already at the top of the ordering. </p>
<div class="fragment"><pre class="fragment">                                   {
  <span class="keywordflow">if</span> ((indexOfSelectedObject &gt; -1)
      &amp;&amp; (indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()))) {
    <span class="keywordtype">int</span> orderingindex = ordering.indexOf(indexOfSelectedObject);
    <span class="keywordflow">if</span> (orderingindex &lt; ordering.size()-1) {
      ordering.move(orderingindex, orderingindex+1);
    }
  }
  setModified(<span class="keyword">true</span>);
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="abcfd1ceeeb682eea101554c3e54f1a70"></a><!-- doxytag: member="Document::sendSelectedToBack" ref="abcfd1ceeeb682eea101554c3e54f1a70" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::sendSelectedToBack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If an object is selected, this slot will move that object's ordering to the back of everything. Nothing will happen if it's already at the back. </p>
<div class="fragment"><pre class="fragment">                                  {
  <span class="keywordflow">if</span> ((indexOfSelectedObject &gt; -1)
      &amp;&amp; (indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()))) {
    ordering.removeAll(indexOfSelectedObject);
    ordering.prepend(indexOfSelectedObject);
  }
  setModified(<span class="keyword">true</span>);
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a425344c7b35fe8903dba675f99d49c2f"></a><!-- doxytag: member="Document::sendSelectedToFront" ref="a425344c7b35fe8903dba675f99d49c2f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::sendSelectedToFront </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If an object is selected, this slot will move that object's ordering to the front of everything. Nothing will happen if it's at the front of everything. </p>
<div class="fragment"><pre class="fragment">                                   {
  <span class="keywordflow">if</span> ((indexOfSelectedObject &gt; -1 )
      &amp;&amp; (indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()))) {
    ordering.removeAll(indexOfSelectedObject);
    ordering.append(indexOfSelectedObject);
  }
  setModified(<span class="keyword">true</span>);
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a89ec2c397b4e8ff253221928ada46a66"></a><!-- doxytag: member="Document::setCanvasIndex" ref="a89ec2c397b4e8ff253221928ada46a66" args="(int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::setCanvasIndex </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ canvasIndex = index; }
</pre></div>
</div>
</div>
<a class="anchor" id="a44757e4a0f79b1928a9f171eef95ae2b"></a><!-- doxytag: member="Document::setDiagramType" ref="a44757e4a0f79b1928a9f171eef95ae2b" args="(BaseNode::DiagramType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::setDiagramType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseNode.html#aa551aa648e877b0717bac9fa58570fcd">BaseNode::DiagramType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td><code> [inline, slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ diagramType = type; }
</pre></div>
</div>
</div>
<a class="anchor" id="a9da7a4058bd8599d86f5b5a1c9124907"></a><!-- doxytag: member="Document::setFilename" ref="a9da7a4058bd8599d86f5b5a1c9124907" args="(QString filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::setFilename </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{ fileName = filename; }
</pre></div>
</div>
</div>
<a class="anchor" id="a651f16a7787831dd5dade529007efdaa"></a><!-- doxytag: member="Document::setNewObjectID" ref="a651f16a7787831dd5dade529007efdaa" args="(int prototypeID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::setNewObjectID </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prototypeID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. Updates the prototypeID for the next object to be created. The signal with the ID should come from the <a class="el" href="classMainWindow.html">MainWindow</a> with the ID being stored in a <a class="el" href="classNodeAction.html">NodeAction</a> created by MainWindow.registerPrototype() </p>
<div class="fragment"><pre class="fragment">                                             {
  newObjectID = prototypeID;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac4fb62b6113ce62934ac1d3948a8e43b"></a><!-- doxytag: member="Document::setSelectedObject" ref="ac4fb62b6113ce62934ac1d3948a8e43b" args="(const QPoint &amp;point)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::setSelectedObject </td>
          <td>(</td>
          <td class="paramtype">const QPoint &amp;&#160;</td>
          <td class="paramname"><em>point</em></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. Updates indexOfSelectedObject based on point. Uses the hitTest function of <a class="el" href="classBaseNode.html">BaseNode</a>. Sets to -1 if no hitTests return true. </p>
<div class="fragment"><pre class="fragment">                                                    {
  assert(indexOfSelectedObject &gt;= -1);
  assert(indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()));

  <span class="comment">// reset the selected property of previously</span>
  <span class="comment">// selected node</span>
  <span class="keywordflow">if</span> (indexOfSelectedObject != -1) {
    <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject)-&gt;setSelected(<span class="keyword">false</span>);
  }

  <span class="comment">// start at the end of the vector and find the</span>
  <span class="comment">// first object with a positive hittest.</span>
  indexOfSelectedObject = getIndexAt(point);

  <span class="keywordflow">if</span> (indexOfSelectedObject != -1) {
    <span class="comment">// set the selection of on the object</span>
    <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject)-&gt;setSelected(<span class="keyword">true</span>);

    <span class="comment">// Save the difference between where the mouse click was (point) and</span>
    <span class="comment">// where the actual middle of the object is. This will be used to</span>
    <span class="comment">// acurately move and drag the object.</span>
    positionDelta = <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject)-&gt;getPosition() - point; }

  <span class="comment">// at this point a redraw is needed to outputshow the new</span>
  <span class="comment">// highlighted object.</span>
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4c282f30904039ff4f984f837dfb58a9"></a><!-- doxytag: member="Document::showPropertiesDialog" ref="a4c282f30904039ff4f984f837dfb58a9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Document::showPropertiesDialog </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [slot]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Slot. This will ask for a new dialog with <a class="el" href="classBaseNode.html#a990ffea58e51f55cfa8c6862b79fd880">BaseNode.getDialog</a> and show it modally. It is the dialog's responsibility to make whatever changes are necessary to the node. </p>
<div class="fragment"><pre class="fragment">                                    {
  assert(indexOfSelectedObject &gt;= -1);
  assert(indexOfSelectedObject &lt; static_cast&lt;int&gt;(<a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.size()));

  <span class="keywordflow">if</span> (indexOfSelectedObject != -1) {
    QDialog *properties;
    properties = <a class="code" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">nodes</a>.at(indexOfSelectedObject)-&gt;getDialog();

    <span class="keywordflow">if</span> (properties != 0) {
      properties-&gt;exec();
      <span class="keyword">delete</span> properties;
    }
  }

  setModified(<span class="keyword">true</span>);
  emit <a class="code" href="classDocument.html#a623b41b297d20acad5aeb477974abfa1">modelChanged</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aa8d3d42254e839f65f176f5ab8e68477"></a><!-- doxytag: member="Document::nodes" ref="aa8d3d42254e839f65f176f5ab8e68477" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classBaseNode.html">BaseNode</a>*&gt; <a class="el" href="classDocument.html#aa8d3d42254e839f65f176f5ab8e68477">Document::nodes</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="document_8h_source.html">document.h</a></li>
<li><a class="el" href="document_8cpp.html">document.cpp</a></li>
</ul>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon May 7 2012 14:45:08 for pUML by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
